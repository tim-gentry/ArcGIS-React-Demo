import{bK as M,bP as h,bo as R,bQ as k,bq as x,bR as O,bJ as v,bw as W,bS as q,bO as B,bT as J,bU as U,bV as Y,bp as _,by as z,bW as K,bX as Q}from"./index-DX0rcHuW.js";import{j,n as S}from"./mat3-Ck4GO2qT.js";import{e as X}from"./mat3f64-BBpwCtoL.js";import{o as d,e as D}from"./mat4f64-Dk4dwAN8.js";import{a as b}from"./spatialReferenceEllipsoidUtils-Bv0mQCFg.js";import{u as L}from"./computeTranslationToOriginAndRotation-B9BchKSd.js";import{t as V,o as H}from"./DoubleArray-tnpOy9RK.js";import{i as F,T as N}from"./BufferView-XrMc2vJu.js";import{f as I,l as G,e as w}from"./vec3-DxxvdsHs.js";import{n as Z}from"./vec4-B2fX0VJI.js";import"./vec2-C-4tM9Uv.js";const Tr="Projection may be possible after calling projection.load().";function Pr(r,o,t,a){r.error(`Failed to project from (wkid:${o.wkid}) to (wkid:${t.wkid}).${a?" ":""}${a}`)}function yr(r,o,t,a,e){return C(A.TO_PCPF,F.fromTypedArray(r),u.NORMAL,N.fromTypedArray(o),N.fromTypedArray(t),a,F.fromTypedArray(e))?e:null}function Ar(r,o,t,a,e){return C(A.FROM_PCPF,F.fromTypedArray(r),u.NORMAL,N.fromTypedArray(o),N.fromTypedArray(t),a,F.fromTypedArray(e))?e:null}function Fr(r,o,t){return M(r,o,0,t,b(o),0,r.length/3)?t:null}function Nr(r,o,t){return M(r,b(t),0,o,t,0,r.length/3)?o:null}function dr(r,o,t){return j(f,t),I(o,r,f),h(f)&&G(o,o),o}function gr(r,o,t){return S(f,t),Z(o,r,f),h(f)&&G(o,o,4),o}function Mr(r,o,t,a){const e=o===u.NORMAL;return $(r,o,t,(i,l)=>{const n=Math.cos(Q(i));l[0]=e?n:1/n,l[1]=1},a)}function br(r,o,t,a){const e=o===u.NORMAL;return $(r,o,t,(i,l)=>{const n=Math.cosh(-i/K.radius);l[0]=1,l[1]=e?n:1/n},a)}function $(r,o,t,a,e){const i=o===u.NORMAL?3:4,l=[0,0];for(let n=0,m=1;n<r.length;n+=i,m+=3){a(t[m],l);const c=r[n]*l[0],p=r[n+1]*l[1],s=r[n+2],P=1/Math.sqrt(c*c+p*p+s*s);e[n]=c*P,e[n+1]=p*P,e[n+2]=s*P,i===4&&(e[n+3]=r[n+3])}return e}function Cr(r,o,t,a,e){if(!C(A.TO_PCPF,F.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),u.TANGENT,N.fromTypedArray(o),N.fromTypedArray(t),a,F.fromTypedArray(e,4*Float32Array.BYTES_PER_ELEMENT)))return null;for(let i=3;i<r.length;i+=4)e[i]=r[i];return e}function Or(r,o,t,a,e){if(!C(A.FROM_PCPF,F.fromTypedArray(r,16),u.TANGENT,N.fromTypedArray(o),N.fromTypedArray(t),a,F.fromTypedArray(e,16)))return null;for(let i=3;i<r.length;i+=4)e[i]=r[i];return e}var u,A;function E(r,o,t,a,e){switch(L(a,t,y,a),r===A.FROM_PCPF&&z(y,y),o){case u.NORMAL:return j(e,y);case u.TANGENT:return S(e,y)}}function C(r,o,t,a,e,i,l){if(!o)return;const n=a.count,m=b(i);if(tr(i))for(let c=0;c<n;c++)e.getVec(c,g),o.getVec(c,T),R(T,T,E(r,t,g,m,f)),l.setVec(c,T);else for(let c=0;c<n;c++){e.getVec(c,g),o.getVec(c,T);const p=k(a.get(c,1));let s=Math.cos(p);t===u.TANGENT!=(r===A.TO_PCPF)&&(s=1/s),E(r,t,g,m,f),r===A.TO_PCPF?(f[0]*=s,f[1]*=s,f[2]*=s,f[3]*=s,f[4]*=s,f[5]*=s):(f[0]*=s,f[3]*=s,f[6]*=s,f[1]*=s,f[4]*=s,f[7]*=s),R(T,T,f),x(T,T),l.setVec(c,T)}return l}function Rr(r){return r.vertexSpace.type==="local"?rr(r):or(r)}function rr({vertexSpace:r,transform:o,inSpatialReference:t,outSpatialReference:a,localMode:e,outPositions:i,positions:l}){const n=r.origin??O,m=r.origin!=null?(o==null?void 0:o.localMatrix)??d:d,c=b(t),p=a.isWebMercator&&e||!v(t,c)?t:c;L(t,n,y,p),W(y,y,m);const s=i??V(l.length);return w(s,l,y),M(s,p,0,s,a,0,s.length/3),s}function or({vertexSpace:r,transform:o,outPositions:t,positions:a,inSpatialReference:e,outSpatialReference:i}){const l=r.origin!=null?(o==null?void 0:o.localMatrix)??d:d,n=t??V(a.length);q(l,d)?H(n,a):w(n,a,l);const m=r.origin??O;if(!B(m,O)){const[c,p,s]=m;for(let P=0;P<n.length;P+=3)n[P]+=c,n[P+1]+=p,n[P+2]+=s}return M(n,e,0,n,i,0,n.length/3)?n:null}function tr(r){return r.isWGS84||J(r)||U(r)||Y(r)}(function(r){r[r.NORMAL=0]="NORMAL",r[r.TANGENT=1]="TANGENT"})(u||(u={})),function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"}(A||(A={}));const g=_(),T=_(),y=D(),f=X();export{u as VectorType,Tr as loadProjectErrorMessage,Pr as logProjectionError,Rr as project,Nr as projectFromPCPF,Ar as projectNormalFromPCPF,yr as projectNormalToPCPF,Or as projectTangentFromPCPF,Cr as projectTangentToPCPF,Fr as projectToPCPF,dr as transformNormal,gr as transformTangent,Mr as transformVectorENUPlateCarree,br as transformVectorWMPlateCarree};

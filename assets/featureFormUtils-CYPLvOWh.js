import{f1 as c,b6 as $,aR as V,f2 as _,f3 as E,aE as b,f4 as L,n as R,f5 as x,f6 as j,f7 as A,be as I}from"./index-DX0rcHuW.js";import{t as U}from"./formUtils-Dni92j4V.js";import{Z}from"./utils-CZ12wTZ2.js";import{s as T}from"./substitute-e0S7rtIE.js";const D=e=>(e==null?void 0:e.type)==="field",F=e=>(e==null?void 0:e.type)==="group",w=e=>(e==null?void 0:e.type)==="relationship",B=e=>e.type==="text",Y=e=>!F(e)&&e.group!=null,N=e=>e.reduce((t,n)=>F(n)?[...t,...n.inputs]:[...t,n],[]),z=e=>N(e).filter(D),J=e=>N(e).filter(w),K=e=>e!=null&&(m(e,"combo-box")||m(e,"radio-buttons")),m=(e,t)=>{var n;return e!=null&&((n=e.input)==null?void 0:n.type)===t},Q=e=>e!=null&&(m(e,"text-box")||m(e,"text-area")),X=({domain:e,inputType:t="text-box",dataType:n})=>n==="number"&&t==="text-box"&&(!e||e.type!=="coded-value"),ee=e=>"items"in e;function te(e){const{attributes:t,fieldsIndex:n,label:r,timeZone:i}=e;if(!t||typeof t!="object")return r;const o=Object.keys(t).filter(s=>c(r,s)),u=o.map(s=>t[s]),a=o.map(s=>n.get(s)).filter($);return H(r,G({values:u,fields:a,timeZone:i}))}const d="expression/",S="expr/",C="field/";function ne(e){const[t,n]=e.split(d);return t===""&&n?n:(R.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${e} is not a valid expression reference of the form '${d}/expressionName'`),"")}function re(e){return`${d}${e}`}function ie(e){return`${C}${e}`}function oe(e){return e.startsWith(d)}function ae(e){return e.startsWith(S)}function G(e){const{fields:t,values:n}=e,r=e.timeZone??void 0,i=t.map((o,u)=>{let a=n[u];if(o.domain&&o.domain.type==="coded-value"){const s=o.domain.codedValues.find(p=>p.code===a);s!=null&&s.name&&(a=s.name)}return(Z(o)||V(o))&&(a=_(o,a,{timeZone:r,...E(o)})),[o.name,a]});return Object.fromEntries(i)}function H(e,t){return b(b(e,n=>`{${n.toLowerCase()}}`),Object.fromEntries(Object.entries(t).map(([n,r])=>[n.toLowerCase(),r])))}const se=e=>{var n,r,i,o;const t={typeFieldName:null,types:[]};return e&&(e.type==="subtype-sublayer"?(t.typeFieldName=(n=e.parent)==null?void 0:n.subtypeField,t.types=((r=e.parent)==null?void 0:r.subtypes)??[]):e.type==="subtype-group"||e.type==="feature"&&((i=e.subtypes)!=null&&i.length)?(t.typeFieldName=e.subtypeField,t.types=e.subtypes??[]):"types"in e&&e.types&&(t.typeFieldName=e.typeIdField,t.types=e.types.map(({id:u,name:a,domains:s})=>({code:u,name:a,domains:s}))),t.typeFieldName!=null&&(t.typeFieldName=((o=e.getField(t.typeFieldName))==null?void 0:o.name)??t.typeFieldName)),t},ue=(e,t)=>{if(!e)return!0;const{operations:n}=e;switch(t){case"INSERT":return n.supportsAdd;case"UPDATE":case"DELETE":return n.supportsUpdate;default:return!0}};var f;(function(e){e.TOO_SHORT="length-validation-error::too-short",e.TOO_LONG="length-validation-error::too-long"})(f||(f={}));const g={type:"number"},O={type:"number",intlOptions:{notation:"scientific"}};function h(e){return e>=1e7||e<=-1e7}function M(e,{validationErrors:t}){return e.max!=null&&e.min!=null?t.outsideRange:e.max!=null?t.outsideRangeMax:t.outsideRangeMin}const le=(e,t,n)=>{const{dataType:r,error:i,minLength:o,value:u,required:a}=e,s=t==null?void 0:t.validationErrors;if(!s||!i)return null;if(a&&u===null)return s.cannotBeNull;if(i===x.VALUE_OUT_OF_RANGE||i===j.OUT_OF_RANGE){const{field:p,range:l}=e,y={type:"date",intlOptions:{timeZone:p.type==="date"&&n?n:void 0,...E(p)}},v=M(l,t);return T(v,l,{format:{max:r==="date"?y:l.max!=null&&h(l.max)?O:g,min:r==="date"?y:l.min!=null&&h(l.min)?O:g}})}return i===x.INVALID_CODED_VALUE?s.invalidCodedValue:i===A.INVALID_TYPE?s.invalidType:i===f.TOO_SHORT?T(s.tooShort,{min:o}):(f.TOO_LONG,null)},pe=e=>{var i;if(!e)return;const t=e.layer,n=t&&"geometryType"in t?t.geometryType:void 0,r=(i=e.geometry)==null?void 0:i.type;return r==="polyline"||n==="polyline"?"line":r==="mesh"||n==="mesh"||n==="multipatch"?"cube":r==="multipoint"||n==="multipoint"?"point":r||n||"table"},me=e=>{var n;const t=[];if(e.formTemplate){const{description:r,title:i}=e.formTemplate;(n=e.fields)==null||n.forEach(o=>{const u=i&&c(i,o.name),a=r&&c(r,o.name);(u||a)&&t.push(o.name)})}return t};function de(e,t){var r;const n=t??("formTemplate"in e&&e.formTemplate);return n?(((r=n.elements)==null?void 0:r.filter(U))??[]).some(({fieldName:i})=>!e.fieldsIndex.get(i)):!1}function fe(e,t){return e==null||t.onValue!==e&&t.offValue!==e}function ce(e,t){var n;switch(t.objectType){case"any":return!0;case"null":return e==null;case"code":return e===((n=t.codedValue)==null?void 0:n.code);case"range":return e!=null&&t.minValue!=null&&t.maxValue!=null&&+e>=t.minValue&&+e<=t.maxValue;default:return L(t.objectType),!1}}function ye(e,t,n){var o,u;if(!e||!("subtypes"in e))return!1;const r=(o=e.subtypes)==null?void 0:o.find(a=>a.code===n);if(!r)return!1;const i=(u=e.subtypes)==null?void 0:u.find(a=>a.code===t);return!I(r.defaultValues,i==null?void 0:i.defaultValues)&&Object.values(r.defaultValues).some(a=>a!=null)}export{ie as $,pe as B,se as C,oe as D,X as E,Q as F,ue as G,ne as I,fe as J,ce as K,f as M,J as N,N as O,ye as Q,re as R,G as S,Y as T,te as U,ee as V,me as Y,F as b,w as g,K as h,z as j,le as q,m as v,ae as w,B as x,D as y,de as z};

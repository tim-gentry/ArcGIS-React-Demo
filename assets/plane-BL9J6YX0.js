import{c$ as a,d7 as j,d4 as q,bq as A,d0 as v,bp as h,d6 as F,h$ as G,bk as D,bO as C,bB as $,d5 as k,bn as H,dk as J,d3 as x}from"./index-DX0rcHuW.js";import{e as K}from"./mat3f64-BBpwCtoL.js";import{e as R}from"./mat4f64-Dk4dwAN8.js";import{e as S}from"./quatf64-BrpT0VRp.js";import{n as U}from"./vec2f64-Diu2Kaa8.js";import{j as W}from"./mathUtils-BsqbT0oM.js";function ht(e,t,r){const c=a(e,t)/a(e,e);return F(r,e,c)}function L(e,t){return a(e,t)/j(e)}function Nt(e,t){const r=a(e,t)/(j(e)*j(t));return-q(r)}function Mt(e,t,r){A(d,e),A(O,t);const c=a(d,O),n=q(c),s=v(d,d,O);return a(s,r)<0?2*Math.PI-n:n}const d=h(),O=h();class u{constructor(t){this._create=t,this._items=new Array,this._itemsPtr=0}get(){return this._itemsPtr===0&&G(()=>this._reset()),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const t=2*this._itemsPtr;this._items.length>t&&(this._items.length=t),this._itemsPtr=0}static createVec2f64(){return new u(U)}static createVec3f64(){return new u(h)}static createVec4f64(){return new u(D)}static createMat3f64(){return new u(K)}static createMat4f64(){return new u(R)}static createQuatf64(){return new u(S)}get test(){}}const $t=u.createVec2f64(),I=u.createVec3f64(),Y=u.createVec4f64();u.createMat3f64();const mt=u.createMat4f64(),gt=u.createQuatf64();function Q(e=_){return[e[0],e[1],e[2],e[3]]}function _t(e=_[0],t=_[1],r=_[2],c=_[3]){return z(e,t,r,c,Y.get())}function Z(e,t){return z(t[0],t[1],t[2],t[3],e)}function Et(e){return e}function z(e,t,r,c,n=Q()){return n[0]=e,n[1]=t,n[2]=r,n[3]=c,n}function Pt(e,t,r){return J(r,e),r[3]=t,r}function tt(e,t,r){const c=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=Math.abs(c-1)>1e-5&&c>1e-12?1/Math.sqrt(c):1;return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=-(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]),r}function et(e,t,r,c=Q()){const n=r[0]-t[0],s=r[1]-t[1],i=r[2]-t[2],o=e[0]-t[0],E=e[1]-t[1],P=e[2]-t[2],m=s*P-i*E,w=i*o-n*P,V=n*E-s*o,y=m*m+w*w+V*V,X=Math.abs(y-1)>1e-5&&y>1e-12?1/Math.sqrt(y):1;return c[0]=m*X,c[1]=w*X,c[2]=V*X,c[3]=-(c[0]*e[0]+c[1]*e[1]+c[2]*e[2]),c}function B(e,t,r,c=0,n=Math.floor(r*(1/3)),s=Math.floor(r*(2/3))){if(r<3)return!1;t(g,c);let i=n,o=!1;for(;i<r-1&&!o;)t(M,i),i++,o=!C(g,M);if(!o)return!1;for(i=Math.max(i,s),o=!1;i<r&&!o;)t(N,i),i++,$(b,g,M),A(b,b),$(l,M,N),A(l,l),o=!C(g,N)&&!C(M,N)&&Math.abs(a(b,l))<rt;return o?(et(g,M,N,e),!0):(c!==0||n!==1||s!==2)&&B(e,t,r,0,1,2)}function dt(e,t,r=!0){const c=t.length/3;return B(e,(n,s)=>x(n,t[3*s+0],t[3*s+1],t[3*s+2]),r?c-1:c)}const rt=.99619469809,g=h(),M=h(),N=h(),b=h(),l=h();function bt(e,t,r){return t!==e&&Z(e,t),e[3]=-a(e,r),e}function lt(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function At(e,t,r,c){return v(N,t,e),tt(r,N,c)}function Ft(e,t,r,c){return p(e,t,$(I.get(),r,t),nt,c)}function Tt(e,t,r){return t!=null&&p(e,t.origin,t.direction,it,r)}function pt(e,t,r){return p(e,t.origin,t.vector,f.NONE,r)}function wt(e,t,r){return p(e,t.origin,t.vector,f.CLAMP,r)}function Vt(e,t){return T(e,t)>=0}function yt(e,t){const r=a(e,t.ray.direction),c=-T(e,t.ray.origin);if(c<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return c>0;if((c<0||r<0)&&!(c<0&&r<0))return!0;const n=c/r;return r>0?n<t.c1&&(t.c1=n):n>t.c0&&(t.c0=n),t.c0<=t.c1}function Xt(e,t){const r=a(e,t.ray.direction),c=-T(e,t.ray.origin);if(r>-1e-6&&r<1e-6)return c>0;const n=c/r;return r>0?n<t.c1&&(t.c1=n):n>t.c0&&(t.c0=n),t.c0<=t.c1}function Ct(e,t,r){const c=F(I.get(),e,-e[3]),n=ct(e,$(I.get(),t,c),I.get());return k(r,n,c),r}function Lt(e,t,r,c){const n=e,s=I.get(),i=I.get();W(n,s,i);const o=$(I.get(),r,t),E=L(s,o),P=L(i,o),m=L(n,o);return x(c,E,P,m)}function ct(e,t,r){const c=F(I.get(),e,a(e,t));return $(r,t,c),r}function Ot(e,t){return Math.abs(T(e,t))}function T(e,t){return a(e,t)+e[3]}function p(e,t,r,c,n){const s=a(e,r);if(s===0)return!1;let i=-(a(e,t)+e[3])/s;return c&f.CLAMP&&(i=H(i,0,1)),!(!(c&f.INFINITE_MIN)&&i<0||!(c&f.INFINITE_MAX)&&i>1)&&(k(n,t,F(n,r,i)),!0)}const _=[0,0,1,0];var f;(function(e){e[e.NONE=0]="NONE",e[e.CLAMP=1]="CLAMP",e[e.INFINITE_MIN=4]="INFINITE_MIN",e[e.INFINITE_MAX=8]="INFINITE_MAX"})(f||(f={}));const nt=f.INFINITE_MIN|f.INFINITE_MAX,it=f.INFINITE_MAX;export{Z as A,wt as B,Vt as D,Q as E,Et as F,yt as G,Xt as H,Ct as J,Lt as K,bt as O,ct as Q,Ot as R,Tt as S,z as T,At as U,T as V,B as X,Pt as _,L as a,et as b,I as c,Nt as d,ht as e,mt as f,dt as g,tt as j,Mt as m,gt as o,lt as q,Y as r,$t as t,_t as v,Ft as w,pt as z};

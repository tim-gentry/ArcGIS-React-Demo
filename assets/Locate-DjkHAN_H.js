const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/calcite-button-B3dK3J4O.js","assets/button-D77aSY9T.js","assets/jsxFactory-DmHi7Kb2.js","assets/index-DX0rcHuW.js","assets/index-B2yzeq1w.css","assets/uuid-fwrPAdZb.js","assets/form-DT0Txu1X.js","assets/dom-Dv5tDaqe.js","assets/interactive-CM5F_5Ay.js","assets/label-CcvHzygA.js","assets/component-ByvC-PUv.js","assets/loadable-BpL5xwNx.js","assets/locale-jvDArz_C.js","assets/key-D5DPfjW0.js","assets/observers-CLdbMMrh.js","assets/t9n-Bv5oqD69.js","assets/icon-CWAu07D3.js","assets/loader-CQvnYTBN.js","assets/calcite-loader-DWyhLzpy.js","assets/calcite-tooltip-CXmK6QYS.js","assets/floating-ui-CVXgJmXk.js","assets/debounce-C5YDvsuO.js","assets/openCloseComponent-BcNBZQe2.js","assets/FloatingArrow-Cy8j4zsH.js"])))=>i.map(i=>d[i]);
import{ac as i,ad as a,ag as b,ib as E,s as h,ap as y,ic as L,gl as M,_ as d,id as g,n as m}from"./index-DX0rcHuW.js";import{e as v,B as T,r as O,n as c}from"./jsxFactory-DmHi7Kb2.js";import{r as C}from"./actions-xqsAfqzZ.js";import{b as P}from"./GeolocationPositioning-DqTbkL_b.js";import{p as S}from"./geolocationUtils-CAAPYkhK.js";import{e as w}from"./globalCss-CZa70j6i.js";import{e as I}from"./vmEvent-D4Ubqkbq.js";import"./uuid-fwrPAdZb.js";import"./legacyIcon-CtsJ0OTG.js";import"./GoTo-Bv8U0vYJ.js";import"./project-BQyPiext.js";import"./utils-nzDIu46v.js";import"./utils-D67OULxu.js";async function N(){const e=await L("esri/widgets/Locate/t9n/Locate");return new M({title:e.currentLocation,fieldInfos:[{fieldName:"timestamp",label:e.timestamp,format:{dateFormat:"short-date-short-time"}},{fieldName:"latitude",label:e.latitude,format:{places:4,digitSeparator:!0}},{fieldName:"longitude",label:e.longitude,format:{places:4,digitSeparator:!0}},{fieldName:"accuracy",label:e.accuracy,format:{places:0,digitSeparator:!0}},{fieldName:"altitude",label:e.altitude,format:{places:0,digitSeparator:!0}},{fieldName:"altitudeAccuracy",label:e.altitudeAccuracy,format:{places:0,digitSeparator:!0}},{fieldName:"heading",label:e.heading,format:{places:0,digitSeparator:!0}},{fieldName:"speed",label:e.speed,format:{places:0,digitSeparator:!0}}],actions:[C.clone()],content:[{type:"fields"}]})}let s=class extends P{constructor(o){super(o),this._locateController=null,this.error=void 0,this.popupEnabled=!0,this.locate=this.locate.bind(this)}initialize(){this.addHandles([E(()=>{var n;const{graphic:o,view:t}=this;if(!o)return;((n=t==null?void 0:t.graphics)==null?void 0:n.includes(o))&&this._updatePopupTemplate(o)})])}destroy(){this.cancelLocate()}get state(){var o;return this._geolocationUsable?(o=this.view)!=null&&o.ready?this._locateController?"locating":this.error!=null?"error":"ready":"disabled":"feature-unsupported"}async locate(){if(this.cancelLocate(),this.state==="disabled")throw new h("locate:disabled-state","Cannot locate when disabled.");if(this.state==="feature-unsupported")throw new h("locate:feature-unsupported-state","Cannot locate in unsecure domain.");const o=new AbortController;this._locateController=o,this.error=void 0;try{const t=await S(this.geolocationOptions);if(await this.updatePosition(t,o),this._locateController!==o)return null;const{graphic:l}=this;return l&&await this._updatePopupTemplate(l),this._addGraphic(),this.emit("locate",{position:t}),this._locateController=null,t}catch(t){if(y(t))return null;throw o===this._locateController&&(this._locateController=null),this.error=t,this.emit("locate-error",{error:t}),t}}cancelLocate(){this._clearGraphic(),this._locateController&&this._locateController.abort(),this._locateController=null}async _updatePopupTemplate(o){if(!this.popupEnabled)return;const t=await N(),l=o!==this.graphic;this.destroyed||l||(o.popupTemplate=t)}};i([a()],s.prototype,"_locateController",void 0),i([a()],s.prototype,"error",void 0),i([a()],s.prototype,"popupEnabled",void 0),i([a({readOnly:!0})],s.prototype,"state",null),i([a()],s.prototype,"locate",null),i([a()],s.prototype,"cancelLocate",null),s=i([b("esri.widgets.Locate.LocateViewModel")],s);const f=s,$={base:"esri-locate"};let r=class extends T{constructor(e,o){super(e,o),this.messages=null,this.messagesCommon=null,this.viewModel=new f,this._locate=()=>{const{viewModel:t}=this;t.state==="locating"?t.cancelLocate():t.locate().catch(()=>{})}}loadDependencies(){return O({button:()=>d(()=>import("./calcite-button-B3dK3J4O.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17])),loader:()=>d(()=>import("./calcite-loader-DWyhLzpy.js"),__vite__mapDeps([18,17,2,3,4,5,7,12,13,14])),tooltip:()=>d(()=>import("./calcite-tooltip-CXmK6QYS.js"),__vite__mapDeps([19,2,3,4,5,7,20,21,22,23]))})}get geolocationOptions(){return this.viewModel.geolocationOptions}set geolocationOptions(e){this.viewModel.geolocationOptions=e}get goToLocationEnabled(){return this.viewModel.goToLocationEnabled}set goToLocationEnabled(e){this.viewModel.goToLocationEnabled=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get icon(){return"gps-off"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(e){this.viewModel.popupEnabled=e}get rotationEnabled(){return g(m.getLogger(this),"rotationEnabled",{replacement:"use Track widget",version:"4.29",warnOnce:!0}),this.viewModel.rotationEnabled}set rotationEnabled(e){g(m.getLogger(this),"rotationEnabled",{replacement:"use Track widget",version:"4.29",warnOnce:!0}),this.viewModel.rotationEnabled=e}get scale(){return this.viewModel.scale}set scale(e){this.viewModel.scale=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}cancelLocate(){this.viewModel.cancelLocate()}locate(){return this.viewModel.locate()}render(){var u;const{viewModel:e,icon:o}=this,{state:t}=e,l=t==="locating",n=l?this.messagesCommon.cancel:this.messages.title,_=t==="feature-unsupported",p=this._localizeError((u=this.viewModel)==null?void 0:u.error);return c("div",{class:this.classes($.base,w.widget)},!_&&c("calcite-button",{class:w.widgetButton,disabled:t==="disabled",iconStart:l?void 0:o,kind:"neutral",label:n,onclick:this._locate,title:n},l?c("calcite-loader",{inline:!0,label:""}):null),p?c("calcite-tooltip",{open:!0,overlayPositioning:"fixed",referenceElement:this.container},p):null)}_localizeError(e){var o,t,l;return e instanceof GeolocationPositionError?e.code===GeolocationPositionError.PERMISSION_DENIED?(o=this.messages)==null?void 0:o.permissionError:e.code===GeolocationPositionError.TIMEOUT?(t=this.messages)==null?void 0:t.timeoutError:(l=this.messages)==null?void 0:l.positionUnavailable:e instanceof Error?e.message:void 0}};i([a()],r.prototype,"geolocationOptions",null),i([a()],r.prototype,"goToLocationEnabled",null),i([a()],r.prototype,"goToOverride",null),i([a()],r.prototype,"graphic",null),i([a()],r.prototype,"icon",null),i([a()],r.prototype,"label",null),i([a(),v("esri/widgets/Locate/t9n/Locate")],r.prototype,"messages",void 0),i([a(),v("esri/t9n/common")],r.prototype,"messagesCommon",void 0),i([a()],r.prototype,"popupEnabled",null),i([a()],r.prototype,"rotationEnabled",null),i([a()],r.prototype,"scale",null),i([a()],r.prototype,"view",null),i([a({type:f}),I(["locate","locate-error"])],r.prototype,"viewModel",void 0),r=i([b("esri.widgets.Locate")],r);const J=r;export{J as default};

import{o as E,G as b}from"./vec2-C-4tM9Uv.js";import{n as T}from"./vec2f64-Diu2Kaa8.js";import{jB as I,dZ as R,jC as A,bK as w}from"./index-DX0rcHuW.js";import{t as g,a as y}from"./DoubleArray-tnpOy9RK.js";import{I as O,t as F}from"./Texture-0jciB86n.js";import{A as S}from"./Indices-BZu2O98k.js";import{l as C}from"./ViewingMode-Dodu7ZZk.js";import{t as d}from"./orientedBoundingBox-BTwqkknQ.js";import{e as v}from"./Material-BfvzXcva.js";import{e as f}from"./VertexAttribute-BnAa5VW0.js";import{p as m,a as D}from"./triangulationUtils-BSy4A0L9.js";import{q as N,t as j}from"./RenderGeometry-CQQOC_nW.js";function it(t,o,n=null){const a=[],s=o.mapPositions;L(o,a);const i=a[0][1].data,r=a[0][1].indices.length,e=S(r);return U(o,a,e),B(o,a,e),x(o,a,e),z(o,a,e),H(o,a,e),P(o,a,e),Z(o,a,i),new O(t,a,s,v.Line,n)}function L(t,o){const{attributeData:{position:n},removeDuplicateStartEnd:a}=t,s=_(n)&&a,i=n.length/3-(s?1:0),r=new Array(2*(i-1)),e=s?n.slice(0,-3):n;let u=0;for(let p=0;p<i-1;p++)r[u++]=p,r[u++]=p+1;o.push([f.POSITION,new d(e,r,3,s)])}function U(t,o,n){if(t.attributeData.colorFeature!=null)return;const a=t.attributeData.color;o.push([f.COLOR,new d(a??I,n,4)])}function x(t,o,n){t.attributeData.normal&&o.push([f.NORMAL,new d(t.attributeData.normal,n,3)])}function z(t,o,n){t.attributeData.colorFeature!=null&&o.push([f.COLORFEATUREATTRIBUTE,new d([t.attributeData.colorFeature],n,1,!0)])}function B(t,o,n){t.attributeData.sizeFeature==null&&o.push([f.SIZE,new d([t.attributeData.size??1],n,1,!0)])}function H(t,o,n){t.attributeData.sizeFeature!=null&&o.push([f.SIZEFEATUREATTRIBUTE,new d([t.attributeData.sizeFeature],n,1,!0)])}function P(t,o,n){t.attributeData.opacityFeature!=null&&o.push([f.OPACITYFEATUREATTRIBUTE,new d([t.attributeData.opacityFeature],n,1,!0)])}function Z(t,o,n){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==C.Global||!t.overlayInfo.spatialReference.isGeographic)return;const a=g(n.length),s=R(t.overlayInfo.spatialReference);for(let h=0;h<a.length;h+=3)A(n,h,a,h,s);const i=n.length/3,r=F(i+1);let e=G,u=M,p=0,c=0;E(e,a[c++],a[c++]),c++,r[0]=0;for(let h=1;h<i+1;++h)h===i&&(c=0),E(u,a[c++],a[c++]),c++,p+=b(e,u),r[h]=p,[e,u]=[u,e];o.push([f.DISTANCETOSTART,new d(r,o[0][1].indices,1,!0)])}function _(t){const o=t.length;return t[0]===t[o-3]&&t[1]===t[o-2]&&t[2]===t[o-1]}const G=T(),M=T();function lt(t,o){if(t==null||t.length===0)return[];const n=[];return t.forEach(a=>{const s=a.length,i=g(3*s);a.forEach((e,u)=>{i[3*u]=e[0],i[3*u+1]=e[1],i[3*u+2]=e[2]});const r={attributeData:{position:i,normal:o},removeDuplicateStartEnd:!1};n.push(r)}),n}function ut(t,o,n,a){const s=t.type==="polygon"?m.CCW_IS_HOLE:m.NONE,i=t.type==="polygon"?t.rings:t.paths,{position:r,outlines:e}=D(i,!!t.hasZ,s,t.spatialReference),u=g(r.length),p=N(r,t.spatialReference,0,u,0,r,0,r.length/3,o,n,a),c=p!=null;return{lines:c?$(e,r,u):[],projectionSuccess:c,sampledElevation:p}}function pt(t,o){const n=t.type==="polygon"?m.CCW_IS_HOLE:m.NONE,a=t.type==="polygon"?t.rings:t.paths,{position:s,outlines:i}=D(a,!1,n),r=w(s,t.spatialReference,0,s,o,0,s.length/3);for(let e=2;e<s.length;e+=3)s[e]=j;return{lines:r?$(i,s):[],projectionSuccess:r}}function $(t,o,n=null){const a=new Array;for(const{index:s,count:i}of t){if(i<=1)continue;const r=3*s,e=3*i;a.push({position:y(o,3*s,3*i),mapPositions:n!=null?y(n,r,e):void 0})}return a}const l={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},W={dash:l.dash,"dash-dot":[...l.dash,...l.dot],dot:l.dot,"long-dash":l["long-dash"],"long-dash-dot":[...l["long-dash"],...l.dot],"long-dash-dot-dot":[...l["long-dash"],...l.dot,...l.dot],none:null,"short-dash":l["short-dash"],"short-dash-dot":[...l["short-dash"],...l["short-dot"]],"short-dash-dot-dot":[...l["short-dash"],...l["short-dot"],...l["short-dot"]],"short-dot":l["short-dot"],solid:null},q=8;function K(t,o){return t==null?t:{pattern:t.slice(),pixelRatio:o}}function ct(t){return{pattern:[t,t],pixelRatio:2}}function ht(t){return t!=null&&t.type==="style"?Y(t.style):null}function Y(t){return t!=null?K(W[t],q):null}export{lt as R,it as b,ct as h,pt as l,ht as n,ut as p};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/calcite-button-B3dK3J4O.js","assets/button-D77aSY9T.js","assets/jsxFactory-DmHi7Kb2.js","assets/index-DX0rcHuW.js","assets/index-B2yzeq1w.css","assets/uuid-fwrPAdZb.js","assets/form-DT0Txu1X.js","assets/dom-Dv5tDaqe.js","assets/interactive-CM5F_5Ay.js","assets/label-CcvHzygA.js","assets/component-ByvC-PUv.js","assets/loadable-BpL5xwNx.js","assets/locale-jvDArz_C.js","assets/key-D5DPfjW0.js","assets/observers-CLdbMMrh.js","assets/t9n-Bv5oqD69.js","assets/icon-CWAu07D3.js","assets/loader-CQvnYTBN.js","assets/calcite-color-picker-CHMN2wqN.js","assets/color-picker-swatch-Bvinex3s.js","assets/math-DqfKmoY3.js","assets/input-message-D42H2lMx.js","assets/input-number-C9dNUp9Q.js","assets/Validation-BmSC9xQN.js","assets/input-Dt5r39B0.js","assets/progress-Cn98mWq-.js","assets/input-text-D19GLHBw.js","assets/tab-DShWdgcr.js","assets/tab-nav-zw6L6rTp.js","assets/core-2D-WamSI.js","assets/tab-title-B9-2hkzg.js","assets/tabs-DpEF7HZj.js","assets/throttle-Dy4QZIDI.js","assets/debounce-C5YDvsuO.js","assets/calcite-popover-CqUVx7C5.js","assets/popover-Zk0D1hdH.js","assets/floating-ui-CVXgJmXk.js","assets/focusTrapComponent-CklV4nIL.js","assets/openCloseComponent-BcNBZQe2.js","assets/Heading-DiaW_And.js","assets/FloatingArrow-Cy8j4zsH.js","assets/action-BdLH7y4R.js","assets/calcite-label-75nr6He8.js","assets/calcite-option-rXI2IAFc.js","assets/calcite-select-DumKFjGo.js","assets/calcite-input-date-picker-zgdw3Uam.js"])))=>i.map(i=>d[i]);
import{ac as i,ad as s,cC as w,V as me,ag as y,bh as z,i8 as h,fr as Pe,eE as Q,cb as _e,bY as m,dN as _,dG as ee,ar as Se,g2 as $e,M as De,dI as G,oa as j,b6 as ke,dH as Oe,jG as Ve,bp as Ee,ob as te,jj as ze,a0 as Me,_ as b,oc as Ie,cx as Re,aF as Ae,aG as xe}from"./index-DX0rcHuW.js";import{s as ve}from"./substitute-e0S7rtIE.js";import{A as ge}from"./Slider-CpGCtdCj.js";import{n as a,f as Le,e as L,B as H,r as N}from"./jsxFactory-DmHi7Kb2.js";import{a as He}from"./earthUtils-GWU8KixL.js";import{D as Ue,t as J}from"./ShadowCastVisualizeTechniqueConfiguration-Dah3u-G-.js";import{e as Fe}from"./throttle-jjSnxk80.js";import{n as Ge}from"./traversalUtils-DmE6QkgJ.js";import{n as x}from"./uuid-fwrPAdZb.js";import{e as K}from"./globalCss-CZa70j6i.js";import{e as ie}from"./Heading-BI51LCyX.js";import{f as Ne,d as je,m as Be,r as We,u as Ye}from"./TimezonePicker-D8qrGAu-.js";import"./mat4f64-Dk4dwAN8.js";import"./vec2-C-4tM9Uv.js";import"./vec2f64-Diu2Kaa8.js";import"./ViewingMode-Dodu7ZZk.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./mathUtils-BsqbT0oM.js";import"./ShaderTechniqueConfiguration-D3UbJ2mX.js";import"./interfaces-B8ge7Jg9.js";const g="esri-shadow-cast",P={base:g,timeRange:`${g}__time-range`,timeRangeIndicator:`${g}__time-range__indicator`,datePickerContainer:`${g}__date-picker-container`,datePicker:`${g}__date-picker`,visualization:`${g}__visualization`,visualizationSelect:`${g}__visualization__select`,visualizationConfigHidden:`${g}__visualization__config--hidden`},qe=`${g}__label`,oe=`${g}__threshold-config`,se={base:oe,valueLabel:`${oe}__value-label`},ne=`${g}__duration-config`,ae={base:ne,radioGroup:`${ne}__radio-group`},Je=`${g}__discrete-config`,Ke={base:Je},re=`${g}__tooltip`,le={base:re,content:`${re}__content`};var A;(function(e){e.Disabled="disabled",e.Ready="ready"})(A||(A={}));let M=class extends z{constructor(){super({}),this.color=new w([50,50,50,.7]),this.intervalOptions=new me([h(15,"minutes","milliseconds"),h(30,"minutes","milliseconds"),h(1,"hours","milliseconds"),h(2,"hours","milliseconds"),h(3,"hours","milliseconds")]),this.interval=this.intervalOptions.at(0)}set intervalOptions(t){this._set("intervalOptions",Pe(t,this._get("intervalOptions")))}};i([s({type:w})],M.prototype,"color",void 0),i([s()],M.prototype,"interval",void 0),i([s({type:me})],M.prototype,"intervalOptions",null),M=i([y("esri.widgets.ShadowCast.DiscreteOptions")],M);const ye=M;var k;(function(e){e.Continuous="continuous",e.Hourly="hourly"})(k||(k={}));let F=class extends z{constructor(){super(...arguments),this.color=new w([0,0,255,.7]),this.mode=k.Continuous}};i([s({type:w})],F.prototype,"color",void 0),i([s()],F.prototype,"mode",void 0),F=i([y("esri.widgets.ShadowCast.DurationOptions")],F);const we=F;var D;(function(e){e.PointerMove="pointer-move",e.Main="main"})(D||(D={}));const Qe=300;let f=class extends z{constructor(t){super(t),this._screenPoint=null,this._accumulatedShadowTime=null,this._shadowTimeTask=null,this._updateAccumulatedShadowTime=(o,n)=>{this._shadowTimeTask=Q(this._shadowTimeTask),this._shadowTimeTask=_e(async r=>{const{results:l,ground:c}=await o.hitTest(n);if(l.length===0&&!c.mapPoint)return void(this._accumulatedShadowTime=null);const T=await this.getDuration(n,r);this._accumulatedShadowTime=T})},this._throttledUpdateAccumulatedShadowTime=Fe(this._updateAccumulatedShadowTime,Qe)}initialize(){this.addHandles(m(()=>({enabled:this.enabled,view:this.view}),({enabled:t,view:o})=>{t&&o!=null?this._startTracking(o):this._stopTracking()},_))}get screenPoint(){return this.enabled?this._screenPoint:null}get accumulatedShadowTime(){return this.enabled?this._accumulatedShadowTime:null}get testData(){}_startTracking(t){if(this.hasHandles(D.Main))return;const o=()=>{this.hasHandles(D.PointerMove)||this.addHandles(t.on("pointer-move",r=>{const l=ee(r.x,r.y);this._screenPoint=l,this._throttledUpdateAccumulatedShadowTime(t,l)}),D.PointerMove)},n=()=>{this.removeHandles(D.PointerMove),this._screenPoint=null,this._accumulatedShadowTime=null};this.addHandles([this._throttledUpdateAccumulatedShadowTime,t.on("pointer-enter",o),t.on("pointer-leave",n),t.on("pointer-down",n),t.on("pointer-drag",n),t.on("pointer-up",o),t.on("click",r=>{const l=ee(r.x,r.y);this._screenPoint=l,this._updateAccumulatedShadowTime(t,l)}),Se(()=>{this._shadowTimeTask=Q(this._shadowTimeTask)})],D.Main),o()}_stopTracking(){this.removeHandles(D.Main)}};i([s()],f.prototype,"getDuration",void 0),i([s()],f.prototype,"view",void 0),i([s()],f.prototype,"enabled",void 0),i([s()],f.prototype,"screenPoint",null),i([s()],f.prototype,"accumulatedShadowTime",null),i([s()],f.prototype,"_screenPoint",void 0),i([s()],f.prototype,"_accumulatedShadowTime",void 0),i([s()],f.prototype,"_shadowTimeTask",void 0),f=i([y("esri.widgets.ShadowCast.ShadowTooltipViewModel")],f);var u;(function(e){e.Threshold="threshold",e.Duration="duration",e.Discrete="discrete"})(u||(u={}));u.Threshold,u.Duration,u.Discrete;let O=class extends z{constructor(){super(...arguments),this.color=new w([255,0,0,.7]),this.value=h(4,"hours","milliseconds"),this.minValue=0,this.maxValue=h(8,"hours","milliseconds")}};i([s({type:w})],O.prototype,"color",void 0),i([s()],O.prototype,"value",void 0),i([s()],O.prototype,"minValue",void 0),i([s()],O.prototype,"maxValue",void 0),O=i([y("esri.widgets.ShadowCast.ThresholdOptions")],O);const be=O,de=[],Xe=Ee(),ce=[],ue=255,Ze=h(1,"hours","milliseconds"),et=500;let d=class extends z{constructor(e){super(e),this.view=null,this.tooltip=new f({getDuration:(t,o)=>this.getDuration(t,o)}),this.startTimeOfDay=h(10,"hours","milliseconds"),this.endTimeOfDay=h(16,"hours","milliseconds"),this.visualizationType=u.Threshold,this.thresholdOptions=new be,this.durationOptions=new we,this.discreteOptions=new ye,this._running=!0,this._stopPreviewingTask=null,this._forcePreview=!1,this._autoRestoreForcePreviewEnabled=!0,this._utcOffset=null,this.date=new Date}initialize(){this.addHandles([m(()=>({view:this.view,tooltipEnabled:this._tooltipEnabled}),({view:e,tooltipEnabled:t})=>{this.tooltip.view=e,this.tooltip.enabled=t},_),m(()=>this._forcePreviewDependencies,()=>{Q(this._stopPreviewingTask),this._forcePreview=!0,this._autoRestoreForcePreviewEnabled&&(this._stopPreviewingTask=_e(async e=>{await $e(et,e),De(e),this._forcePreview=!1}))},_),m(()=>({renderer:this.renderer,parameters:this._visualizationParameters}),e=>U(e.renderer,e.parameters),_),m(()=>({renderer:this.renderer,parameters:{lightDirections:this._lightDirections}}),e=>U(e.renderer,e.parameters),_),m(()=>({renderer:this.renderer,parameters:{enabled:this._running}}),e=>U(e.renderer,e.parameters),_),m(()=>({renderer:this.renderer,parameters:{previewing:this._previewing}}),e=>U(e.renderer,e.parameters),_)])}destroy(){this.stop(),U(this.renderer,{enabled:!1}),G(this.tooltip)}get state(){return this.view!=null&&this.view.ready&&this._referencePosition!=null?A.Ready:A.Disabled}set date(e){const t=new Date(e);t.setHours(0,0,0,0),this._set("date",t)}get utcOffset(){return this._utcOffset??this._utcOffsetAuto}set utcOffset(e){this._utcOffset=e}get testData(){}get _previewing(){const{view:e}=this;return(e==null?void 0:e.allLayerViews)==null||this._forcePreview||!e.stationary||e.allLayerViews.some(t=>X(t)&&t.updating)}get _utcOffsetAuto(){const e=this._referencePosition;return e!=null?He(e[0],!1):0}get _dateUTCOffset(){let e=this.date;return e=j(e,-e.getTimezoneOffset(),"minutes"),e=j(e,-this.utcOffset,"hours"),e}get _startDateTimeUTC(){return j(this._dateUTCOffset,this.startTimeOfDay)}get _endDateTimeUTC(){return j(this._dateUTCOffset,this.endTimeOfDay)}get _referencePosition(){var e,t;return(t=(e=this.view)==null?void 0:e.environmentManager)==null?void 0:t.referencePositionGeographic}get _interval(){const e=this._duration>0?Math.floor(this._duration/ue):ue,t=this.discreteOptions.interval;switch(this.visualizationType){case u.Threshold:case u.Duration:return e;case u.Discrete:return t>0?t:e}}get _sampleCount(){return this._lightDirections.length}get _duration(){return this.endTimeOfDay-this.startTimeOfDay}get _lightDirections(){const{view:e}=this;if(e==null)return de;const t=e.viewingMode==="global"?Xe:this._referencePosition;if(t==null)return de;const o=this._interval,n=Ue(this._startDateTimeUTC,this._endDateTimeUTC,o,t,e.state.viewingMode),r=n.length;ce.length=0;const l=Ge(0,r,ce),c=new Array(r);for(let T=0;T<r;++T)c[T]=n[l[T]];return c}get _tooltipEnabled(){return this.state===A.Ready&&this.visualizationType!==u.Discrete&&this._running&&!this._previewing}get _visualizationParameters(){if(!this._running)return null;switch(this.visualizationType){case u.Threshold:return this._thresholdVisualizationParameters;case u.Duration:return this._durationVisualizationParameters;case u.Discrete:return this._discreteVisualizationParameters}}get _thresholdVisualizationParameters(){const{value:e,color:t}=this.thresholdOptions,o=this._duration;return{visualization:J.Threshold,color:w.toUnitRGBA(t),threshold:o>0?e/this._duration:0}}get _durationVisualizationParameters(){const{color:e,mode:t}=this.durationOptions,o=this._duration,n=o>0&&t===k.Hourly?Ze/o:0;return{color:w.toUnitRGBA(e),visualization:J.Gradient,bandsEnabled:n>0,bandSize:n}}get _discreteVisualizationParameters(){return{color:w.toUnitRGBA(this.discreteOptions.color),visualization:J.Gradient,bandsEnabled:!1,bandSize:0}}get _forcePreviewDependencies(){const{view:e}=this;if(e==null)return null;const t=e.slicePlane,o=e.allLayerViews.toArray().filter(X),n=o.map(p=>p.layer).filter(ke),r=o.map(p=>p.visible),l=n.map(p=>p.visible),c=n.map(p=>p.opacity),T=n.filter(p=>"definitionExpression"in p).map(p=>p.definitionExpression),Te=o.filter(p=>"filter"in p).map(p=>p.filter);return{slicePlane:t,startDateUTC:this._startDateTimeUTC,endDateUTC:this._endDateTimeUTC,layerViewVisibilities:r,layerVisibilities:l,layerOpacities:c,filters:Te,definitionExpressions:T}}get renderer(){const{view:e}=this;if(e==null)return null;const t=e._stage;return t==null?null:t.renderer}start(){this.setRunning(!0)}stop(){this.setRunning(!1)}setRunning(e){this._running=e}async getDuration(e,t){const{view:o,renderer:n}=this;if(o==null||n==null)return 0;const r=o.state.camera.screenToRender(Oe(e.x,e.y),Ve()),l=n.readAccumulatedShadow(r),c=this._sampleCount;return c===0?0:l*c*(this._duration/c)}};function U(e,t){e!=null&&t!=null&&e.setParameters({shadowCast:t})}function X(e){if(e.suspended)return!1;switch(e.type){case"building-scene-3d":case"csv-3d":case"elevation-3d":case"feature-3d":case"geojson-3d":case"graphics-3d":case"integrated-mesh-3d":case"integrated-mesh-3dtiles":case"ogc-feature-3d":case"route-3d":case"scene-layer-3d":case"scene-layer-graphics-3d":case"stream-3d":case"wms-3d":return!0;case"base-dynamic-3d":case"catalog-3d":case"catalog-footprint-3d":case"catalog-dynamic-group-3d":case"dimension-3d":case"imagery-3d":case"imagery-tile-3d":case"line-of-sight-3d":case"map-image-3d":case"point-cloud-3d":case"tile-3d":case"vector-tile-3d":case"voxel-3d":case"wfs-3d":case"wmts-3d":case"media-3d":default:return!1;case"group":return e.layerViews.toArray().some(t=>X(t))}}i([s()],d.prototype,"state",null),i([s()],d.prototype,"view",void 0),i([s()],d.prototype,"tooltip",void 0),i([s({nonNullable:!0})],d.prototype,"date",null),i([s({nonNullable:!0})],d.prototype,"utcOffset",null),i([s({nonNullable:!0})],d.prototype,"startTimeOfDay",void 0),i([s({nonNullable:!0})],d.prototype,"endTimeOfDay",void 0),i([s({nonNullable:!0})],d.prototype,"visualizationType",void 0),i([s({type:be,nonNullable:!0})],d.prototype,"thresholdOptions",void 0),i([s({type:we,nonNullable:!0})],d.prototype,"durationOptions",void 0),i([s({type:ye,nonNullable:!0})],d.prototype,"discreteOptions",void 0),i([s()],d.prototype,"_running",void 0),i([s()],d.prototype,"_stopPreviewingTask",void 0),i([s()],d.prototype,"_forcePreview",void 0),i([s()],d.prototype,"_autoRestoreForcePreviewEnabled",void 0),i([s()],d.prototype,"_previewing",null),i([s()],d.prototype,"_utcOffset",void 0),i([s()],d.prototype,"_utcOffsetAuto",null),i([s()],d.prototype,"_dateUTCOffset",null),i([s()],d.prototype,"_startDateTimeUTC",null),i([s()],d.prototype,"_endDateTimeUTC",null),i([s()],d.prototype,"_referencePosition",null),i([s()],d.prototype,"_interval",null),i([s()],d.prototype,"_sampleCount",null),i([s()],d.prototype,"_duration",null),i([s()],d.prototype,"_lightDirections",null),i([s()],d.prototype,"_tooltipEnabled",null),i([s()],d.prototype,"_visualizationParameters",null),i([s()],d.prototype,"_thresholdVisualizationParameters",null),i([s()],d.prototype,"_durationVisualizationParameters",null),i([s()],d.prototype,"_discreteVisualizationParameters",null),i([s()],d.prototype,"_forcePreviewDependencies",null),i([s()],d.prototype,"renderer",null),d=i([y("esri.widgets.ShadowCast.ShadowCastViewModel")],d);const tt=d;let S=class extends z{constructor(){super(...arguments),this.timeRangeSlider=!0,this.timezone=!0,this.datePicker=!0,this.visualizationOptions=!0,this.colorPicker=!0,this.tooltip=!0}};i([s()],S.prototype,"timeRangeSlider",void 0),i([s()],S.prototype,"timezone",void 0),i([s()],S.prototype,"datePicker",void 0),i([s()],S.prototype,"visualizationOptions",void 0),i([s()],S.prototype,"colorPicker",void 0),i([s()],S.prototype,"tooltip",void 0),S=i([y("esri.widgets.ShadowCast.ShadowCastVisibleElements")],S);const fe=S;function Ce(e,t="milliseconds",o={}){const n={locale:it(),numberingSystem:"latn"};let r;return r=e?te.fromMillis(h(e,t,"milliseconds"),n).rescale():te.fromObject({seconds:0},n),r.toHuman({listStyle:"narrow",unitDisplay:"long",...o})}function it(){return ze()==="bs"?"hr":Me()}function q(e,t){const{for:o,label:n,tabIndex:r,...l}=e;return a("div",{class:Le(qe,l==null?void 0:l.class),key:o,...l},a("calcite-label",{for:o,scale:"s",tabIndex:r},n),t)}const B="esri-color-picker",W={base:B,backgroundPattern:`${B}__bg-pattern`,toggleButton:`${B}__toggle-button`,popover:`${B}__popover`};let C=class extends H{constructor(e,t){super(e,t),this.value=new w,this.alphaEnabled=!0,this._containerElement=null,this._button=null,this._open=!1,this._onColorInput=o=>{var l;const n=o.target.value,r=typeof n=="string"?new w(n):new w;this.value=r,(l=this.onChange)==null||l.call(this,r)}}initialize(){this.addHandles(m(()=>({container:this._containerElement,value:this.value}),({container:e,value:t})=>{e==null||e.style.setProperty("--esri-color-picker-value",t.toCss(!0))},_))}loadDependencies(){return N({button:()=>b(()=>import("./calcite-button-B3dK3J4O.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17])),"color-picker":()=>b(()=>import("./calcite-color-picker-CHMN2wqN.js"),__vite__mapDeps([18,2,3,4,5,19,7,8,13,11,12,14,20,15,1,6,9,10,16,17,21,22,23,24,25,26,27,28,29,30,31,32,33])),popover:()=>b(()=>import("./calcite-popover-CqUVx7C5.js"),__vite__mapDeps([34,35,2,3,4,5,36,7,33,37,38,39,12,13,14,15,11,40,10,41,8,16,17]))})}render(){const e=this._messages,t=this._open?e.close:e.open;return a("div",{afterCreate:o=>this._containerElement=o,class:this.classes(W.base,this.class)},a("div",{class:W.backgroundPattern,key:"background-pattern"}),a("calcite-button",{afterCreate:o=>this._button=o,appearance:"transparent",class:W.toggleButton,key:"popover-trigger",kind:"neutral",label:t,scale:"s",tabIndex:-1,title:t}),a("calcite-popover",{autoClose:!0,class:W.popover,key:"popover",label:e.label,overlayPositioning:"fixed",referenceElement:this._button,onCalcitePopoverClose:()=>this._open=!1,onCalcitePopoverOpen:()=>this._open=!0},a("calcite-color-picker",{alphaChannel:this.alphaEnabled,channelsDisabled:!0,key:"color-picker",savedDisabled:!0,value:this.value.toCss(),onCalciteColorPickerInput:this._onColorInput})))}};i([s()],C.prototype,"class",void 0),i([s()],C.prototype,"value",void 0),i([s()],C.prototype,"alphaEnabled",void 0),i([s()],C.prototype,"onChange",void 0),i([s()],C.prototype,"_containerElement",void 0),i([s()],C.prototype,"_button",void 0),i([s()],C.prototype,"_open",void 0),i([s(),L("esri/widgets/support/t9n/ColorPicker")],C.prototype,"_messages",void 0),C=i([y("esri.widgets.support.ColorPicker")],C);function Z(e){return a(q,{for:e.id,label:e.label,tabIndex:-1},a(C,{id:e.id,value:e.value,onChange:e.onChange}))}let I=class extends H{constructor(t){super(t),this.colorPickerVisible=!0,this._selectId=`select-${x()}`,this._colorPickerId=`color-picker-${x()}`,this._onColorChange=o=>{this.options.color=o}}loadDependencies(){return N({label:()=>b(()=>import("./calcite-label-75nr6He8.js"),__vite__mapDeps([42,2,3,4,5,9,7,10])),option:()=>b(()=>import("./calcite-option-rXI2IAFc.js"),__vite__mapDeps([43,2,3,4,5,14])),select:()=>b(()=>import("./calcite-select-DumKFjGo.js"),__vite__mapDeps([44,2,3,4,5,7,6,8,9,10,11,14,23,16,21]))})}render(){const t=this._messages.discrete,o=t.intervalLabel,{color:n,interval:r,intervalOptions:l}=this.options;return a("div",{class:Ke.base},a(q,{for:this._selectId,label:o},a("calcite-select",{bind:this,id:this._selectId,label:o,onCalciteSelectChange:this._onIntervalChange},l.toArray().map(c=>a("calcite-option",{key:c,selected:c===r,value:String(c)},Ce(c))))),this.colorPickerVisible?a(Z,{id:this._colorPickerId,label:t.colorLabel,value:n,onChange:this._onColorChange}):null)}_onIntervalChange(t){var n;const o=parseInt((n=t.target.selectedOption)==null?void 0:n.value,10);Number.isFinite(o)&&(this.options.interval=o)}};i([s()],I.prototype,"options",void 0),i([s()],I.prototype,"colorPickerVisible",void 0),i([s(),L("esri/widgets/ShadowCast/t9n/ShadowCast")],I.prototype,"_messages",void 0),I=i([y("esri.widgets.ShadowCast.components.DiscreteConfigurator")],I);let R=class extends H{constructor(t){super(t),this.colorPickerVisible=!0,this._modeSelectorId=`mode-selector-${x()}`,this._colorPickerId=`color-picker-${x()}`,this._onColorChange=o=>{this.options.color=o},this._setContinuous=()=>{this.options.mode=k.Continuous},this._setHourly=()=>{this.options.mode=k.Hourly}}loadDependencies(){return N({button:()=>b(()=>import("./calcite-button-B3dK3J4O.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17])),label:()=>b(()=>import("./calcite-label-75nr6He8.js"),__vite__mapDeps([42,2,3,4,5,9,7,10]))})}render(){const t=this._messages.duration,{color:o,mode:n}=this.options;return a("div",{class:ae.base},a(q,{for:this._modeSelectorId,label:t.modeLabel},a("div",{class:ae.radioGroup},a(he,{active:n===k.Continuous,label:t.continuousLabel,onclick:this._setContinuous}),a(he,{active:n===k.Hourly,label:t.hourlyLabel,onclick:this._setHourly}))),this.colorPickerVisible?a(Z,{id:this._colorPickerId,label:t.colorLabel,value:o,onChange:this._onColorChange}):null)}};function he({active:e,label:t,...o}){return a("calcite-button",{alignment:"center",appearance:e?"solid":"outline",scale:"s",width:"half",...o},t)}i([s()],R.prototype,"options",void 0),i([s()],R.prototype,"colorPickerVisible",void 0),i([s(),L("esri/widgets/ShadowCast/t9n/ShadowCast")],R.prototype,"_messages",void 0),R=i([y("esri.widgets.ShadowCast.components.DurationConfigurator")],R);const ot=h(1,"minutes","milliseconds"),pe=h(15,"minutes","milliseconds");let V=class extends H{constructor(e,t){super(e,t),this.accumulatedShadowTime=null,this._messages=null}render(){const e=this._formattedContent;return a("div",{class:le.base},e?a("div",{class:le.content},e):null)}get _formattedContent(){const e=this._messages,t=this.accumulatedShadowTime;if(e==null||t==null)return null;const o=Ie(t,t<pe?ot:pe);return ve(e.timeInShadow,{duration:Ce(o)})}};i([s()],V.prototype,"accumulatedShadowTime",void 0),i([s()],V.prototype,"view",void 0),i([s(),L("esri/widgets/ShadowCast/t9n/ShadowCast")],V.prototype,"_messages",void 0),i([s({readOnly:!0})],V.prototype,"_formattedContent",null),V=i([y("esri.widgets.ShadowCast.components.ShadowTooltipContent")],V);let E=class extends z{constructor(e){super(e),this._updateHandle=null,this._contentContainer=this._createContainer()}initialize(){this.container.appendChild(this._contentContainer),this._contentWidget=new V({},this._contentContainer),this._updateHandle=m(()=>{const e=this._contentContainer,{screenPoint:t,accumulatedShadowTime:o}=this.viewModel.tooltip;return{contentContainer:e,screenPoint:t,accumulatedShadowTime:o}},e=>this._update(e),_)}destroy(){this._updateHandle=Re(this._updateHandle),this._contentWidget=G(this._contentWidget),this.container.contains(this._contentContainer)&&this.container.removeChild(this._contentContainer)}get testData(){}_update({contentContainer:e,screenPoint:t,accumulatedShadowTime:o}){const{style:n}=e;t!=null?(n.display="block",n.transform=`translate(${t.x}px, ${t.y}px)`,this._contentWidget.accumulatedShadowTime=o):n.display="none"}_createContainer(){const e=document.createElement("div"),{style:t}=e;return t.position="absolute",t.top="0",t.left="0",e}};i([s()],E.prototype,"viewModel",void 0),i([s()],E.prototype,"container",void 0),i([s()],E.prototype,"_contentContainer",void 0),i([s()],E.prototype,"_contentWidget",void 0),E=i([y("esri.widgets.ShadowCast.components.ShadowTooltip")],E);let $=class extends H{constructor(e){super(e),this.colorPickerVisible=!0,this._valueSliderId=`value-slider-${x()}`,this._colorPickerId=`color-picker-${x()}`,this._valueSlider=new ge({visibleElements:{labels:!1,rangeLabels:!1},steps:h(30,"minutes","milliseconds"),labelFormatFunction:(t,o)=>{const n=h(t,"milliseconds","hours");return o==="tick"?Ae(n,{maximumFractionDigits:0}):""}}),this._onColorChange=t=>{this.options.color=t}}initialize(){const e=({value:t})=>{this.options.value=t};this.addHandles([m(()=>{const{value:t,minValue:o,maxValue:n}=this.options;return{value:t,minValue:o,maxValue:n}},({value:t,minValue:o,maxValue:n})=>{const r=this._valueSlider;r.min=o,r.max=n,r.values=[t];const l=n-o,c=Math.floor(h(l,"milliseconds","hours"));r.tickConfigs=[{mode:"count",values:2*c+1,labelsVisible:!1},{mode:"count",values:c+1,labelsVisible:!0}]},_),this._valueSlider.on("thumb-change",e),this._valueSlider.on("thumb-drag",e)])}loadDependencies(){return N({label:()=>b(()=>import("./calcite-label-75nr6He8.js"),__vite__mapDeps([42,2,3,4,5,9,7,10]))})}destroy(){this._valueSlider=G(this._valueSlider)}render(){const e=this._messages.threshold,{color:t}=this.options;return a("div",{class:se.base},a(q,{class:se.valueLabel,for:this._valueSliderId,label:e.valueLabel},this._valueSlider.render()),this.colorPickerVisible?a(Z,{id:this._colorPickerId,label:e.colorLabel,value:t,onChange:this._onColorChange}):null)}get testData(){}};i([s()],$.prototype,"options",void 0),i([s()],$.prototype,"colorPickerVisible",void 0),i([s()],$.prototype,"testData",null),i([s()],$.prototype,"_valueSlider",void 0),i([s(),L("esri/widgets/ShadowCast/t9n/ShadowCast")],$.prototype,"_messages",void 0),$=i([y("esri.widgets.ShadowCast.components.ThresholdConfigurator")],$);var Y;(function(e){e.Slider="slider"})(Y||(Y={}));const st={labelFormatFunction:Be,min:0,max:1439,steps:15,rangeLabelInputsEnabled:!1,visibleElements:{labels:!1,rangeLabels:!1},tickConfigs:[{mode:"position",values:[0,360,720,1080,1439],labelsVisible:!0,tickCreatedFunction:(e,t,o)=>We({tickElement:t,labelElement:o})},{mode:"position",values:[120,240,480,600,840,960,1200,1320],tickCreatedFunction:(e,t)=>Ye({tickElement:t})}]};let v=class extends H{constructor(e,t){super(e,t),this.viewModel=null,this.headingLevel=4,this.visibleElements=new fe,this._defaultViewModel=null,this._timeSlider=new ge({...st,container:document.createElement("div")}),this._tooltip=null,this._onTimezoneChange=o=>{this.viewModel.utcOffset=o},this._onDateChange=o=>{const n=o.target.valueAsDate;this.viewModel.date=Array.isArray(n)?n[0]:n},e!=null&&e.viewModel||(this._defaultViewModel=new tt({view:e==null?void 0:e.view}),this.viewModel=this._defaultViewModel)}initialize(){this.addHandles([m(()=>({viewModel:this.viewModel,slider:this._timeSlider}),e=>this._connectTimeSlider(e),_),m(()=>{var e;return{container:(e=this.view)==null?void 0:e.surface,viewModel:this.viewModel,tooltipVisible:this.visibleElements.tooltip}},({container:e,viewModel:t,tooltipVisible:o})=>{this._tooltip=G(this._tooltip),e!=null&&o&&(this._tooltip=new E({viewModel:t,container:e}))},_),m(()=>({viewModel:this.viewModel,visible:this.visible}),({viewModel:e,visible:t})=>e.setRunning(t),_)])}destroy(){this._timeSlider=G(this._timeSlider),this._defaultViewModel!=null&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}loadDependencies(){return N({"input-date-picker":()=>b(()=>import("./calcite-input-date-picker-zgdw3Uam.js"),__vite__mapDeps([45,2,3,4,5,12,7,13,14,36,33,6,8,9,10,11,38,15,39,16,37,23,24,21,26,25])),option:()=>b(()=>import("./calcite-option-rXI2IAFc.js"),__vite__mapDeps([43,2,3,4,5,14])),select:()=>b(()=>import("./calcite-select-DumKFjGo.js"),__vite__mapDeps([44,2,3,4,5,7,6,8,9,10,11,14,23,16,21]))})}render(){const{visibleElements:e,viewModel:t}=this,o=t.state===A.Disabled;return a("div",{class:this.classes(P.base,K.widget,K.panel,{[K.widgetDisabled]:o}),key:this},this._renderTimeRangeSection(),e.visualizationOptions?this._renderVisualizationOptionsSection():null)}get view(){var e;return(e=this.viewModel)==null?void 0:e.view}set view(e){this.viewModel&&(this.viewModel.view=e)}get icon(){return"measure-building-height-shadow"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get testData(){}_connectTimeSlider({viewModel:e,slider:t}){if(this.removeHandles(Y.Slider),t==null)return;const o=l=>h(l,"milliseconds","minutes"),n=l=>h(l,"minutes","milliseconds"),r=({index:l,value:c})=>{l===0?e.startTimeOfDay=n(c):e.endTimeOfDay=n(c)};this.addHandles([m(()=>[e.startTimeOfDay,e.endTimeOfDay],l=>{t.values=l.map(o)},_),t.on("thumb-change",r),t.on("thumb-drag",r),t.on("segment-drag",()=>{[e.startTimeOfDay,e.endTimeOfDay]=t.values.map(n)})],Y.Slider)}_renderTimeRangeSection(){const{visibleElements:e}=this;return e.timeRangeSlider||e.datePicker?a("section",{class:P.timeRange,key:"time-range"},a(ie,{level:this.headingLevel},this.messages.timeLabel),e.timeRangeSlider?this._renderTimeRange():null,e.datePicker?this._renderDatePicker():null):null}_renderTimeRange(){const{messages:e,viewModel:t,visibleElements:o}=this,{startTimeOfDay:n,endTimeOfDay:r}=t,[l,c]=[n,r].map(T=>xe(new Date(T),Ne));return[a("div",{class:P.timeRangeIndicator,key:"time-range-indicator"},ve(e.timeRange,{start:l,end:c}),o.timezone?a(je,{value:t.utcOffset,onChange:this._onTimezoneChange}):null),a("div",{afterCreate:this._timeSliderContainerAfterCreate,afterRemoved:this._timeSliderContainerAfterRemoved,bind:this,key:"time-slider-container"})]}_timeSliderContainerAfterCreate(e){var o;const t=(o=this._timeSlider)==null?void 0:o.container;t&&e.appendChild(t)}_timeSliderContainerAfterRemoved(e){var o;const t=(o=this._timeSlider)==null?void 0:o.container;t&&e.removeChild(t)}_renderDatePicker(){return a("div",{class:P.datePickerContainer,key:P.datePickerContainer},a("calcite-input-date-picker",{class:P.datePicker,"data-testid":"date-picker",key:P.datePicker,overlayPositioning:"fixed",placement:"bottom",valueAsDate:this.viewModel.date,onCalciteInputDatePickerChange:this._onDateChange}))}_renderVisualizationOptionsSection(){const{headingLevel:e,messages:t,viewModel:o,visibleElements:n}=this,r=n.colorPicker,l=c=>this.classes(o.visualizationType===c?null:P.visualizationConfigHidden);return a("section",{class:P.visualization,key:"visualization"},a(ie,{level:e},t.visualizationLabel),this._renderVisualizationSelect(),a("div",{class:l(u.Threshold),key:"threshold-configurator"},a($,{colorPickerVisible:r,options:o.thresholdOptions})),a("div",{class:l(u.Duration),key:"duration-configurator"},a(R,{colorPickerVisible:r,options:o.durationOptions})),a("div",{class:l(u.Discrete),key:"discrete-configurator"},a(I,{colorPickerVisible:r,options:o.discreteOptions})))}_renderVisualizationSelect(){const e=this.messages,t=this.viewModel.visualizationType;return a("calcite-select",{bind:this,class:P.visualizationSelect,key:"visualization-select",label:e.visualizationLabel,onCalciteSelectChange:this._onVisualizationTypeChange},[{type:u.Threshold,label:e.threshold.label},{type:u.Duration,label:e.duration.label},{type:u.Discrete,label:e.discrete.label}].map(({type:o,label:n})=>a("calcite-option",{selected:o===t,value:o},n)))}_onVisualizationTypeChange(e){var o;const t=(o=e.target.selectedOption)==null?void 0:o.value;this.viewModel.visualizationType=t??u.Threshold}};i([s()],v.prototype,"viewModel",void 0),i([s()],v.prototype,"view",null),i([s()],v.prototype,"headingLevel",void 0),i([s()],v.prototype,"icon",null),i([s()],v.prototype,"label",null),i([s({type:fe,nonNullable:!0})],v.prototype,"visibleElements",void 0),i([s(),L("esri/widgets/ShadowCast/t9n/ShadowCast")],v.prototype,"messages",void 0),i([s()],v.prototype,"_defaultViewModel",void 0),i([s()],v.prototype,"_timeSlider",void 0),i([s()],v.prototype,"_tooltip",void 0),v=i([y("esri.widgets.ShadowCast")],v);const Vt=v;export{Vt as default};
